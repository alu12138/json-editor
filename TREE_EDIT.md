# 左侧树形菜单编辑功能

## 功能概览

现在左侧树形菜单中的每个节点都支持直接查看值、编辑值、以及为数组和对象添加新项。

## 界面说明

### 叶子节点（最终值）
```
name: "John"          ← 直接显示 key: value
age: 30               ← 支持点击"编辑"按钮修改
active: true
```

每个叶子节点右侧都有一个 **编辑** 按钮。

### 数组和对象节点
```
users: [object]       ← 不显示值，因为是容器类型
config: {object}
```

数组和对象节点右侧都有一个 **添加** 按钮。

## 功能使用

### 1. 编辑叶子节点的值

**步骤：**
1. 在树形菜单中找到要编辑的字段（显示为 `key: value` 的形式）
2. 点击该行右侧的 **编辑** 按钮
3. 弹窗中输入新值（需要是有效的 JSON 格式）
4. 点击"确定"完成修改

**示例：**
```
编辑前：name: "John"
编辑对话框中输入："Alice"
编辑后：name: "Alice"
```

### 2. 为数组或对象添加新项

**步骤：**
1. 点击数组或对象节点右侧的 **添加** 按钮
2. 弹窗中：
   - **Key**：如果是对象，输入新字段的键名；数组可不填
   - **Value**：输入新值（必须是有效的 JSON 格式）
3. 点击"确定"完成添加

**示例 - 为数组添加元素：**
```json
users: [
  {"name": "John"},
  {"name": "Alice"}   ← 新添加的
]
```
点击 `users` 的添加按钮，在 Value 中输入：`{"name": "Alice"}`

**示例 - 为对象添加字段：**
```json
config: {
  "host": "localhost",
  "debug": true       ← 新添加的
}
```
点击 `config` 的添加按钮，Key 输入：`debug`，Value 输入：`true`

### 3. 删除节点

- 选中树中的任何节点（点击节点名称）
- 点击左上方的 **删除** 按钮
- 确认删除即可

## JSON 格式说明

在编辑或添加值时，需要遵循 JSON 格式：

| 类型 | 示例 | 说明 |
|------|------|------|
| 字符串 | `"hello"` | 必须用双引号 |
| 数字 | `123` | 整数或小数 |
| 布尔值 | `true` / `false` | 小写 |
| 数组 | `[1, 2, 3]` | 方括号 |
| 对象 | `{"a": 1}` | 大括号 |
| null | `null` | 特殊值 |

❌ **错误示例：**
```
'hello'              ← 应该用双引号，不是单引号
{"a": undefined}     ← undefined 不是有效的 JSON
True                 ← 应该用 true，不是 True
[1, 2, 3,]           ← 不能有尾部逗号
```

## 修改跟踪

✅ 所有修改会自动被系统记录，右侧预览区会用 **红色字体** 标记修改过的字段。

你可以：
- 勾选右侧的 **"只显示修改"** 复选框来只查看修改的部分
- 导出 JSON 获取修改后的完整文件

## 工作流示例

### 场景：修改配置文件

**原始 JSON：**
```json
{
  "server": {
    "host": "localhost",
    "port": 3000
  },
  "database": {
    "name": "mydb"
  }
}
```

**操作步骤：**

1. 编辑 `host` 的值
   - 点击 `host: "localhost"` 的编辑按钮
   - 改为 `"0.0.0.0"`
   - 确定

2. 编辑 `port` 的值
   - 点击 `port: 3000` 的编辑按钮
   - 改为 `8080`
   - 确定

3. 为 `server` 添加新字段
   - 点击 `server` 节点的添加按钮
   - Key：`ssl`
   - Value：`true`
   - 确定

4. 导出修改后的 JSON
   - 点击左侧的 **导出 JSON** 按钮
   - 下载到本地

**修改后的 JSON：**
```json
{
  "server": {
    "host": "0.0.0.0",      ← 已修改
    "port": 8080,           ← 已修改
    "ssl": true             ← 新添加
  },
  "database": {
    "name": "mydb"
  }
}
```

## 快捷操作

| 操作 | 方法 |
|------|------|
| 编辑值 | 点击叶子节点右侧的"编辑" |
| 添加字段 | 点击对象/数组节点右侧的"添加" |
| 删除节点 | 选中节点后点击左侧的"删除" |
| 批量修改 | 在左侧搜索框搜索，点击"批量修改" |
| 查看修改 | 右侧勾选"只显示修改" |

## 常见问题

**Q: 编辑时提示"值格式错误"？**
A: 检查 JSON 格式是否正确。例如字符串必须用双引号，布尔值用小写 true/false。

**Q: 为什么无法编辑数组或对象节点？**
A: 因为数组和对象是容器类型，应该用"添加"按钮来添加元素。如果要修改它的值，应该修改其中的具体元素。

**Q: 添加后想删除该项怎么办？**
A: 在树形菜单中选中该项，然后点击左侧的"删除"按钮。

**Q: 修改后怎么撤销？**
A: 目前不支持撤销。可以重新上传原始文件。


